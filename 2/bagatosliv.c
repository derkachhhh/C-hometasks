#include <stdio.h>

// Функція для конвертації числа в 32-бітний бінарний формат
void decimal_to_32bit_binary(int decimal, char *binary_str) {
    // Проходимо по кожному біту від старшого (31) до молодшого (0)
    for (int i = 31; i >= 0; i--) {
        // Перевіряємо, чи біт на позиції i встановлений в 1 чи 0
        // Для цього зсуваємо 1 на i позицій вправо і застосовуємо операцію AND (&)
        // Якщо біт є 1, то в рядок додаємо '1', інакше - '0'
        binary_str[31 - i] = (decimal & (1 << i)) ? '1' : '0';
    }
    // Додаємо нульовий символ в кінець рядка для позначення його завершення
    binary_str[32] = '\0';
}

// Основна функція для XOR-шифрування та дешифрування
void xor_cipher(int original_value, int key, int show_binary) {
    int encrypted = original_value ^ key;  // Шифруємо значення за допомогою XOR з ключем
    int decrypted = encrypted ^ key;       // Дешифруємо значення, ще раз застосовуючи XOR з тим же ключем

    char binary_str[33];  // Рядок для зберігання 32-бітного бінарного представлення

    // Виведення результатів шифрування
    printf("\nРезультати:\n");

    // Виводимо оригінальне значення в десятковому вигляді
    printf("Оригінальне значення (десяткове): %d\n", original_value);

    // Якщо користувач обрав опцію для виведення двійкового представлення, конвертуємо в бінарний вигляд
    if (show_binary) {
        decimal_to_32bit_binary(original_value, binary_str);
        printf("Двійковий: %s\n", binary_str);
    }

    // Виводимо зашифроване значення в десятковому вигляді
    printf("Зашифроване значення (десяткове): %d\n", encrypted);

    // Якщо користувач обрав опцію для виведення двійкового представлення, конвертуємо в бінарний вигляд
    if (show_binary) {
        decimal_to_32bit_binary(encrypted, binary_str);
        printf("Двійковий: %s\n", binary_str);
    }

    // Виводимо розшифроване значення в десятковому вигляді, воно повинно дорівнювати оригінальному
    printf("Розшифроване значення (оригінал): %d\n", decrypted);

    // Якщо користувач обрав опцію для виведення двійкового представлення, конвертуємо в бінарний вигляд
    if (show_binary) {
        decimal_to_32bit_binary(decrypted, binary_str);
        printf("Двійковий: %s\n", binary_str);
    }
}

// Функція для введення значення з підказкою
int input_value(const char* prompt) {
    int value;
    printf("%s", prompt);
    scanf("%d", &value);
    return value;
}

int main() {
    int value = input_value("Введіть значення: ");         // Зчитуємо оригінальне значення
    int key = input_value("Введіть ключ: ");               // Зчитуємо ключ для XOR-шифрування
    int show_binary = input_value("Увімкнути багатослівний режим? (1 - так, 0 - ні): "); // Вибір режиму виведення

    xor_cipher(value, key, show_binary);  // Викликаємо функцію для шифрування та дешифрування

    return 0;  // Завершуємо програму
}
